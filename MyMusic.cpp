// MyMusic.cpp : \u5B9A\u4E49\u5E94\u7528\u7A0B\u5E8F\u7684\u7C7B\u884C\u4E3A\u3002
//

#include "stdafx.h"
#include "MyMusic.h"
#include "MyMusicDlg.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif


// CMyMusicApp

BEGIN_MESSAGE_MAP(CMyMusicApp, CWinApp)
	ON_COMMAND(ID_HELP, &CWinApp::OnHelp)
END_MESSAGE_MAP()


// CMyMusicApp \u6784\u9020

CMyMusicApp::CMyMusicApp()
{
	// \u652F\u6301\u91CD\u65B0\u542F\u52A8\u7BA1\u7406\u5668
	m_dwRestartManagerSupportFlags = AFX_RESTART_MANAGER_SUPPORT_RESTART;

	// TODO: \u5728\u6B64\u5904\u6DFB\u52A0\u6784\u9020\u4EE3\u7801\uFF0C
	// \u5C06\u6240\u6709\u91CD\u8981\u7684\u521D\u59CB\u5316\u653E\u7F6E\u5728 InitInstance \u4E2D
}


// \u552F\u4E00\u7684\u4E00\u4E2A CMyMusicApp \u5BF9\u8C61

CMyMusicApp theApp;


// CMyMusicApp \u521D\u59CB\u5316

BOOL CMyMusicApp::InitInstance()
{
	// \u5982\u679C\u4E00\u4E2A\u8FD0\u884C\u5728 Windows XP \u4E0A\u7684\u5E94\u7528\u7A0B\u5E8F\u6E05\u5355\u6307\u5B9A\u8981
	// \u4F7F\u7528 ComCtl32.dll \u7248\u672C 6 \u6216\u66F4\u9AD8\u7248\u672C\u6765\u542F\u7528\u53EF\u89C6\u5316\u65B9\u5F0F\uFF0C
	//\u5219\u9700\u8981 InitCommonControlsEx()\u3002\u5426\u5219\uFF0C\u5C06\u65E0\u6CD5\u521B\u5EFA\u7A97\u53E3\u3002
	INITCOMMONCONTROLSEX InitCtrls;
	InitCtrls.dwSize = sizeof(InitCtrls);
	// \u5C06\u5B83\u8BBE\u7F6E\u4E3A\u5305\u62EC\u6240\u6709\u8981\u5728\u5E94\u7528\u7A0B\u5E8F\u4E2D\u4F7F\u7528\u7684
	// \u516C\u5171\u63A7\u4EF6\u7C7B\u3002
	InitCtrls.dwICC = ICC_WIN95_CLASSES;
	InitCommonControlsEx(&InitCtrls);

	CWinApp::InitInstance();


	AfxEnableControlContainer();

	// \u521B\u5EFA shell \u7BA1\u7406\u5668\uFF0C\u4EE5\u9632\u5BF9\u8BDD\u6846\u5305\u542B
	// \u4EFB\u4F55 shell \u6811\u89C6\u56FE\u63A7\u4EF6\u6216 shell \u5217\u8868\u89C6\u56FE\u63A7\u4EF6\u3002
	CShellManager *pShellManager = new CShellManager;

	// \u6807\u51C6\u521D\u59CB\u5316
	// \u5982\u679C\u672A\u4F7F\u7528\u8FD9\u4E9B\u529F\u80FD\u5E76\u5E0C\u671B\u51CF\u5C0F
	// \u6700\u7EC8\u53EF\u6267\u884C\u6587\u4EF6\u7684\u5927\u5C0F\uFF0C\u5219\u5E94\u79FB\u9664\u4E0B\u5217
	// \u4E0D\u9700\u8981\u7684\u7279\u5B9A\u521D\u59CB\u5316\u4F8B\u7A0B
	// \u66F4\u6539\u7528\u4E8E\u5B58\u50A8\u8BBE\u7F6E\u7684\u6CE8\u518C\u8868\u9879
	// TODO: \u5E94\u9002\u5F53\u4FEE\u6539\u8BE5\u5B57\u7B26\u4E32\uFF0C
	// \u4F8B\u5982\u4FEE\u6539\u4E3A\u516C\u53F8\u6216\u7EC4\u7EC7\u540D
	SetRegistryKey(_T("\u5E94\u7528\u7A0B\u5E8F\u5411\u5BFC\u751F\u6210\u7684\u672C\u5730\u5E94\u7528\u7A0B\u5E8F"));

	CMyMusicDlg dlg;
	m_pMainWnd = &dlg;
	INT_PTR nResponse = dlg.DoModal();
	if (nResponse == IDOK)
	{
		// TODO: \u5728\u6B64\u653E\u7F6E\u5904\u7406\u4F55\u65F6\u7528
		//  \u201C\u786E\u5B9A\u201D\u6765\u5173\u95ED\u5BF9\u8BDD\u6846\u7684\u4EE3\u7801
	}
	else if (nResponse == IDCANCEL)
	{
		// TODO: \u5728\u6B64\u653E\u7F6E\u5904\u7406\u4F55\u65F6\u7528
		//  \u201C\u53D6\u6D88\u201D\u6765\u5173\u95ED\u5BF9\u8BDD\u6846\u7684\u4EE3\u7801
	}

	// \u5220\u9664\u4E0A\u9762\u521B\u5EFA\u7684 shell \u7BA1\u7406\u5668\u3002
	if (pShellManager != NULL)
	{
		delete pShellManager;
	}

	// \u7531\u4E8E\u5BF9\u8BDD\u6846\u5DF2\u5173\u95ED\uFF0C\u6240\u4EE5\u5C06\u8FD4\u56DE FALSE \u4EE5\u4FBF\u9000\u51FA\u5E94\u7528\u7A0B\u5E8F\uFF0C
	//  \u800C\u4E0D\u662F\u542F\u52A8\u5E94\u7528\u7A0B\u5E8F\u7684\u6D88\u606F\u6CF5\u3002
	return FALSE;
}

